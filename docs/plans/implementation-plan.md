# 計算プリント自動作成サービス 実装計画

## プロジェクト概要
フロントエンドで完結し、PDFで印刷できる計算プリントを自動作成するWebアプリケーション

## 技術選定

### フロントエンドフレームワーク
- **React** + **TypeScript**: コンポーネントベースの開発と型安全性
- **Vite**: 高速な開発環境

### PDF生成
- **pdfmake**: 宣言的なAPI、複数列レイアウトのサポート、日本語フォント対応
- 代替案: **pdf-lib** (より細かい制御が必要な場合)

### スタイリング
- **Tailwind CSS**: ユーティリティファーストで高速な開発
- **CSS Modules**: コンポーネント固有のスタイリング

### 状態管理
- **Zustand**: シンプルで軽量な状態管理

## プロジェクト構造

```
math-worksheet/
├── src/
│   ├── components/
│   │   ├── Layout/
│   │   │   ├── Header.tsx
│   │   │   ├── Footer.tsx
│   │   │   └── Container.tsx
│   │   ├── ProblemGenerator/
│   │   │   ├── ProblemTypeSelector.tsx
│   │   │   ├── SettingsPanel.tsx
│   │   │   └── GenerateButton.tsx
│   │   ├── Preview/
│   │   │   ├── WorksheetPreview.tsx
│   │   │   ├── ProblemList.tsx
│   │   │   └── HissanProblem.tsx
│   │   └── Export/
│   │       ├── PDFExporter.tsx
│   │       └── PrintButton.tsx
│   ├── lib/
│   │   ├── generators/
│   │   │   ├── addition.ts
│   │   │   ├── subtraction.ts
│   │   │   ├── multiplication.ts
│   │   │   ├── division.ts
│   │   │   └── types.ts
│   │   ├── pdf/
│   │   │   ├── templates/
│   │   │   ├── fonts/
│   │   │   └── generator.ts
│   │   └── utils/
│   │       ├── math.ts
│   │       └── format.ts
│   ├── stores/
│   │   ├── problemStore.ts
│   │   └── settingsStore.ts
│   ├── types/
│   │   └── index.ts
│   ├── App.tsx
│   └── main.tsx
├── public/
│   └── fonts/
│       └── NotoSansJP-Regular.ttf
└── package.json
```

## 主要機能

### 1. 問題タイプ選択
- 学年別（1年生〜6年生）
- 演算別（たし算、ひき算、かけ算、わり算）
- 難易度別（桁数、繰り上がり有無など）
- 特殊形式（筆算、虫食い算、文章題）

### 2. レイアウト設定
- 列数選択（1列、2列、3列、カスタム）
- 問題数設定
- 余白調整
- フォントサイズ調整
- ヘッダー/フッター設定（名前欄、日付欄、点数欄）

### 3. 問題生成エンジン
- 各演算タイプに対応した生成ロジック
- 繰り上がり/繰り下がりの制御
- 答えの範囲制限
- 重複チェック
- 教育的配慮（段階的難易度など）

### 4. プレビュー機能
- リアルタイムプレビュー
- 印刷イメージの確認
- 問題の再生成
- 個別問題の編集/削除

### 5. PDF出力
- A4サイズ最適化
- 日本語フォント埋め込み
- 印刷品質保証
- ファイル名自動生成

## 実装優先順位

### Phase 1: MVP（最小実行可能製品）
1. 基本的なUIレイアウト
2. 簡単なたし算・ひき算の生成（1桁〜2桁）
3. 1列レイアウトでのPDF出力
4. 基本的なヘッダー（名前欄のみ）

### Phase 2: 基本機能拡充
1. かけ算・わり算の追加
2. 2列・3列レイアウト対応
3. 繰り上がり/繰り下がり制御
4. 学年別プリセット

### Phase 3: 高度な機能
1. 筆算レイアウト
2. 虫食い算
3. 問題の保存/読み込み
4. 印刷履歴管理

### Phase 4: 教育的機能
1. 文章題生成
2. 分数・小数計算
3. 解答用紙の別紙出力
4. 学習進度管理

## 開発スケジュール（目安）

- **Phase 1**: 1週間
- **Phase 2**: 2週間
- **Phase 3**: 2週間
- **Phase 4**: 3週間

## 技術的課題と解決策

### 1. 日本語フォントのサイズ問題
- **解決策**: フォントのサブセット化、Web Font Loaderの活用

### 2. 筆算レイアウトの複雑性
- **解決策**: CSS GridとFlexboxの組み合わせ、専用コンポーネント化

### 3. PDF生成のパフォーマンス
- **解決策**: Web Workerでのバックグラウンド処理、プログレスバー表示

### 4. モバイル対応
- **解決策**: レスポンシブデザイン、タッチ操作の最適化

## 次のステップ

1. プロジェクトの基本構造をセットアップ
2. 開発環境の構築（React + Vite + TypeScript）
3. 基本的なUIコンポーネントの作成
4. 簡単な問題生成ロジックの実装
5. PDF出力機能のプロトタイプ作成

この計画に基づいて、段階的に機能を実装していくことで、高品質な計算プリント自動作成サービスを構築できます。