# 虫食い算（Missing Number Problems）設計書

## 概要

虫食い算を計算パターンシステムに統合し、学年別・難易度別に適切な問題を生成する。

## 設計方針

### 1. 計算パターンへの統合

各学年の計算パターンに虫食い算バリエーションを追加：

```typescript
// 1年生の例
'add-single-digit-missing' // □ + 3 = 5 のような虫食い算
'sub-single-digit-missing' // 8 - □ = 3 のような虫食い算

// 2年生の例
'add-double-digit-missing' // 23 + □ = 45 のような虫食い算
'mult-single-digit-missing' // □ × 3 = 12 のような九九の虫食い算
```

### 2. 問題生成の統一

現在のBasicProblem型を拡張して虫食い算に対応：

```typescript
interface BasicProblem {
  id: string;
  type: 'basic';
  operation: Operation;
  operand1: number | null;  // nullの場合は□として表示
  operand2: number | null;  // nullの場合は□として表示
  answer: number | null;    // nullの場合は□として表示
  carryOver?: boolean;
  missingPosition?: 'operand1' | 'operand2' | 'answer'; // どの位置が虫食いか
}
```

### 3. 難易度設計

#### 1年生
- □ + 2 = 5（簡単な足し算の虫食い）
- 7 - □ = 3（簡単な引き算の虫食い）
- 答えが10以下の範囲

#### 2年生
- □ + 25 = 43（2桁の虫食い）
- □ × 3 = 12（九九の虫食い）
- 56 - □ = 23（2桁の引き算の虫食い）

#### 3年生以上
- より大きな数での虫食い算
- 小数・分数での虫食い算
- 複数の空欄がある問題

## 実装計画

### Phase 1: 基本実装
1. 計算パターンに虫食い算パターンを追加
2. 虫食い算生成ロジックの実装
3. 表示ロジックの改善

### Phase 2: UI改善
1. 虫食い算専用の入力欄（印刷時は下線）
2. 答え合わせ機能の追加

### Phase 3: 高度な機能
1. 複数空欄の虫食い算
2. 連立方程式的な虫食い算
3. パズル要素の強い虫食い算

## 利点

1. **統一的なシステム**
   - 計算パターンシステムに統合することで、一貫性のある実装が可能
   - 学年別の難易度調整が容易

2. **段階的な実装**
   - 基本的な虫食い算から始めて、徐々に高度な機能を追加可能

3. **教育的価値**
   - 逆算の力を鍛える
   - 論理的思考力の向上